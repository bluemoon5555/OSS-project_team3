#define _CRT_SECURE_NO_WARNINGS
#include <stdio.h>
#include <windows.h>
#include <stdlib.h>
#include <conio.h>

// --------------- 한 글자씩 출력하는 함수 ---------------
void slowPrintChar(const char* text, int delay) {
    while (*text) {
        putchar(*text);
        fflush(stdout);
        Sleep(delay);
        text++;
    }
}

// --------------- 장면(여러 줄) 출력 후 화면 전환 ---------------
void scene(const char* text) {
    slowPrintChar(text, 28);
    printf("\n\n[Enter 키를 누르면 다음 장면으로 넘어갑니다]");
    _getch();
    system("cls"); // 장면 종료 후 화면 클리어
}

void printMenu();
void startGame();
void loadGame();

int main() {
    int choice;

    while (1) {
        printMenu();
        printf("\n 숫자를 눌러 선택하세요: ");
        scanf("%d", &choice);

        switch (choice) {
        case 1:
            system("cls"); // 메뉴 화면 지우고 게임 시작
            startGame();
            break;
        case 2:
            loadGame();
            break;
        case 3:
            printf("게임을 종료합니다...\n");
            Sleep(700);
            return 0;
        default:
            printf("잘못된 입력입니다.\n");
            Sleep(700);
        }
    }
    return 0;
}

// ---------------------- 메뉴 ----------------------
void printMenu() {
    system("cls");

    printf("=========================================\n");
    printf("|                                       |\n");
    printf("|                                       |\n");
    printf("|             공포 RPG 게임             |\n");
    printf("|                                       |\n");
    printf("|             [1] START                 |\n");
    printf("|             [2] LOAD                  |\n");
    printf("|             [3] EXIT                  |\n");
    printf("|                                       |\n");
    printf("|        숫자를 눌러 시작하세요...      |\n");
    printf("|                                       |\n");
    printf("=========================================\n");
}


// ---------------------- 게임 시작 ----------------------
void startGame() {

    // ---- 장면 1 ----
    scene(
        "(좁은 원룸, 책상 위에는 노트북과 이력서가 어지럽게 놓여 있다.)\n"
        "(올해로 29살인 최종훈은 00대학교 컴퓨터공학과를 졸업한 뒤 3년째 취업에 실패하고 있다.)\n"
        "최종훈 : ...... 또 떨어졌네.\n"
        "벌써 몇 번째인지도 모르겠는 불합격 통보… 이제는 그냥 무덤덤하다.\n"
        "남은 돈은 30만원... 이제 어떻게 해야 하지..."
    );

    // ---- 장면 2 ----
    scene(
        "(노트북에서 갑자기 메일 알람이 울린다.)\n"
        "\"월 천만원 보장!!\" \"주 3일 근무!\"\n"
        "터무니없이 좋은 조건들...\n"
        "입사 시 500만원 지급이라니...\n"
        "분명히 사기 같지만... 지금 내 상황에서는 너무나 절실하다."
    );

    // ---- 장면 3 ----
    scene(
        "(몇 시간 동안 고민하던 끝에 결국 결심한다.)\n"
        "그래... 일단 연락이라도 해보자.\n"
        "(취업 홍보 메일을 보낸 회사에 연락한다.)"
    );

    // ---- 장면 4 ----
    scene(
        "================ 화면전환 ================\n\n"
        "(다음날, 외곽 산업단지)\n"
        "여기가 면접장소라고...? 왜 이렇게 사람이 없지...\n"
        "(검은 벤, 문신 가득한 남자들)"
    );

    // ---- 장면 5 ----
    scene(
        "최종훈 : 안녕하세요... 면접 보러 왔습니다...\n"
        "남자들 : 타.\n"
        "(불안하지만 차량에 탑승한다.)\n"
        "..... 이거 뭔가 잘못되고 있는거 같은데..."
    );

    // ---- 장면 6 ----
    scene(
        "(차량은 도시를 벗어나 한 시간 넘게 오지를 향해 달린다)\n"
        "최종훈 : 저기... 회사가 어디쯤—\n"
        "(퍽!!!)\n"
        "이게... 무슨......\n"
        "(의식을 잃는다)"
    );

    // ---- 장면 7 ----
    scene(
        "================ 화면전환 ================\n\n"
        "(작은 독방... 콘크리트 벽, 쇠창살, 낡은 노트북)\n"
        "으... 머리가...\n"
        "여긴... 어디지...?"
    );

    // ---- 장면 8 ----
    scene(
        "(문이 열리고 보스와 거구의 남자들이 들어온다)\n"
        "보스 : 넌 이제 우리의 새 식구다.\n"
        "보스 : 보이스피싱, 불법 도박사이트 관리. 네 일은 이 두 가지다.\n"
        "최종훈 : 네...?! 제발 여기서 나가게 해주세요...\n"
        "보스 : 하하하... 여기서 나간 사람은 단 한 명도 없다."
    );

    // ---- 장면 9 ----
    scene(
        "================ 화면전환 ================\n\n"
        "(어두운 방, 노트북 앞에 앉은 최종훈)\n"
        "보이스피싱 스크립트 작성...\n"
        "도박사이트 관리...\n"
        "여기 온 지 한 달...\n"
        "몸은 피멍투성이, 살은 10kg 넘게 빠졌다."
    );

    // ---- 장면 10 ----
    scene(
        "(복도에서 비명소리)\n"
        "조직원 : 할당량 못 채우면 죽여버린다 했지!!!!\n"
        "(다른 피해자의 울음)\n"
        "최종훈 : 더는... 이렇게 살 수 없어...\n"
        "탈출해야 해... 무슨 일이 있어도."
    );

    // ---- 장면 11 ----
    scene(
        "================ 화면전환 ================\n\n"
        "(며칠 뒤, 건물 청소 작업에 동원된 최종훈)\n"
        "좁은 독방을 벗어날 수 있는 유일한 시간...\n"
        "그는 건물 구조를 파악하기 시작했다.\n"
        "4층 구조... 정문 외 모든 곳은 가시 담장...\n"
        "정문은 열쇠 필요... 1층은 열쇠함... 2층에는 보안실..."
    );

    // ---- 마지막 안내 ----
    scene(
        "(스토리 파트 1 끝)\n"
        "메뉴로 돌아갑니다..."
    );
}


// ---------------------- LOAD ----------------------
void loadGame() {
    system("cls");
    slowPrintChar("LOAD 기능은 아직 준비중입니다.\n", 30);
    slowPrintChar("추후 체크포인트 기능이 추가됩니다.\n", 30);
    slowPrintChar("메뉴로 돌아갑니다...", 30);
    Sleep(1500);
    system("cls");
}
